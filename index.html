<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Additive Color Mixing Cube</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #000;
            color: white;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        #header {
            background: rgba(15, 15, 20, 0.98);
            padding: 18px 24px;
            border-bottom: 2px solid #333;
        }
        h1 {
            font-size: 26px;
            margin-bottom: 6px;
            background: linear-gradient(90deg, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }
        .subtitle { color: #999; font-size: 13px; margin-bottom: 10px; }
        #info {
            background: rgba(30, 30, 40, 0.9);
            padding: 14px 18px;
            border-radius: 12px;
            border: 1px solid #444;
        }
        .current-color {
            font-weight: 900;
            font-size: 24px;
            margin-bottom: 8px;
            text-align: center;
            text-shadow: 0 0 30px currentColor;
            letter-spacing: 1px;
        }
        .mixing-formula {
            font-size: 13px;
            text-align: center;
            margin-top: 6px;
            color: #ddd;
            min-height: 32px;
        }
        .surprise-note {
            font-size: 11px;
            color: #ffaa00;
            text-align: center;
            margin-top: 6px;
            font-style: italic;
        }
        #container { flex: 1; position: relative; }
        #footer {
            background: rgba(15, 15, 20, 0.98);
            padding: 12px 20px;
            border-top: 2px solid #333;
            text-align: center;
        }
        .footer-content { font-size: 12px; color: #888; line-height: 1.6; }
    </style>
</head>
<body>
    <div id="header">
        <h1>ADDITIVE LIGHT COLOR MIXING</h1>
        <p class="subtitle">Watch how light beams combine in surprising ways - totally different from mixing paints!</p>
        <div id="info">
            <div class="current-color" id="colorInfo">Initializing...</div>
            <div class="mixing-formula" id="mixingFormula"></div>
            <div class="surprise-note" id="surpriseNote"></div>
        </div>
    </div>
    <div id="container"></div>
    <div id="footer">
        <div class="footer-content">
            LIGHT: Red + Green = Yellow • All Colors = White | PIGMENTS: Red + Green = Brown • All Colors = Muddy Brown
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        var container = document.getElementById('container');
        var colorInfo = document.getElementById('colorInfo');
        var mixingFormula = document.getElementById('mixingFormula');
        var surpriseNote = document.getElementById('surpriseNote');

        var scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000000);

        var camera = new THREE.PerspectiveCamera(50, container.clientWidth / container.clientHeight, 0.1, 1000);
        camera.position.set(0, 0, 6);

        var renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        var R = 0xff0000, G = 0x00ff00, B = 0x0000ff;

        var verts = [
            { n: 'BLACK', c: [], x: -1.4, y: -1.4, z: -1.4, s: 'Absence of all light' },
            { n: 'RED', c: [R], x: 1.4, y: -1.4, z: -1.4, s: 'Primary light - pure red' },
            { n: 'YELLOW', c: [R, G], x: 1.4, y: 1.4, z: -1.4, s: 'SURPRISE! Red + Green = Yellow (not brown!)' },
            { n: 'GREEN', c: [G], x: -1.4, y: 1.4, z: -1.4, s: 'Primary light - pure green' },
            { n: 'BLUE', c: [B], x: -1.4, y: -1.4, z: 1.4, s: 'Primary light - pure blue' },
            { n: 'MAGENTA', c: [R, B], x: 1.4, y: -1.4, z: 1.4, s: 'Red + Blue combined!' },
            { n: 'WHITE', c: [R, G, B], x: 1.4, y: 1.4, z: 1.4, s: 'ALL light colors = BRIGHT WHITE!' },
            { n: 'CYAN', c: [G, B], x: -1.4, y: 1.4, z: 1.4, s: 'Green + Blue combined!' }
        ];

        function mix(colors) {
            var r = 0, g = 0, b = 0, i;
            for (i = 0; i < colors.length; i++) {
                r += (colors[i] >> 16) & 0xFF;
                g += (colors[i] >> 8) & 0xFF;
                b += colors[i] & 0xFF;
            }
            r = Math.min(255, r);
            g = Math.min(255, g);
            b = Math.min(255, b);
            return (r << 16) | (g << 8) | b;
        }

        for (var i = 0; i < verts.length; i++) {
            verts[i].m = verts[i].c.length > 0 ? mix(verts[i].c) : 0x000000;
        }

        var cube = new THREE.Group();
        scene.add(cube);

        var ctr = new THREE.Mesh(
            new THREE.SphereGeometry(0.65, 32, 32),
            new THREE.MeshBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.8 })
        );
        scene.add(ctr);

        var g1 = new THREE.Mesh(
            new THREE.SphereGeometry(1.0, 24, 24),
            new THREE.MeshBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.3 })
        );
        scene.add(g1);

        var g2 = new THREE.Mesh(
            new THREE.SphereGeometry(1.4, 16, 16),
            new THREE.MeshBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.15 })
        );
        scene.add(g2);

        var nodes = [];
        var v, sz, geo, mat, n, og1, og2, ig, lt;
        
        for (i = 0; i < verts.length; i++) {
            v = verts[i];
            sz = i === 0 ? 0.25 : 0.42;
            
            geo = new THREE.SphereGeometry(sz, 32, 32);
            mat = new THREE.MeshBasicMaterial({ color: v.m, transparent: true, opacity: i === 0 ? 0.5 : 0.95 });
            n = new THREE.Mesh(geo, mat);
            n.position.set(v.x, v.y, v.z);
            cube.add(n);
            nodes.push(n);

            if (i !== 0) {
                og1 = new THREE.Mesh(
                    new THREE.SphereGeometry(sz * 1.6, 16, 16),
                    new THREE.MeshBasicMaterial({ color: v.m, transparent: true, opacity: 0.4 })
                );
                n.add(og1);

                og2 = new THREE.Mesh(
                    new THREE.SphereGeometry(sz * 2.2, 16, 16),
                    new THREE.MeshBasicMaterial({ color: v.m, transparent: true, opacity: 0.2 })
                );
                n.add(og2);

                ig = new THREE.Mesh(
                    new THREE.SphereGeometry(sz * 1.15, 16, 16),
                    new THREE.MeshBasicMaterial({ color: v.m, transparent: true, opacity: 0.6 })
                );
                n.add(ig);
            }

            lt = new THREE.PointLight(v.m, i === 0 ? 0.5 : 3.5, i === 0 ? 3 : 12);
            lt.position.set(v.x, v.y, v.z);
            cube.add(lt);
        }

        var edges = [[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];
        var eMat = new THREE.LineBasicMaterial({ color: 0x1a1a1a, transparent: true, opacity: 0.4 });
        
        for (i = 0; i < edges.length; i++) {
            var e = edges[i];
            var v1 = verts[e[0]];
            var v2 = verts[e[1]];
            var pts = [new THREE.Vector3(v1.x, v1.y, v1.z), new THREE.Vector3(v2.x, v2.y, v2.z)];
            var lg = new THREE.BufferGeometry().setFromPoints(pts);
            var ln = new THREE.Line(lg, eMat);
            cube.add(ln);
        }

        var seq = [
            { v: 0, r: { x: 0.785, y: -0.785, z: 0 } },
            { v: 1, r: { x: 0.785, y: 0.785, z: 0 } },
            { v: 2, r: { x: -0.785, y: 0.785, z: 3.14159 } },
            { v: 3, r: { x: -0.785, y: -0.785, z: 0 } },
            { v: 7, r: { x: 0.785, y: -0.785, z: 3.14159 } },
            { v: 4, r: { x: 0.785, y: 0.785, z: 3.14159 } },
            { v: 5, r: { x: -0.785, y: 0.785, z: 0 } },
            { v: 6, r: { x: -0.785, y: -0.785, z: 3.14159 } }
        ];

        var t = 0;
        var tDur = 2.5;
        var hDur = 2.0;

        function getName(hex) {
            if (hex === R) return 'Red';
            if (hex === G) return 'Green';
            if (hex === B) return 'Blue';
            return 'Light';
        }

        function shortRot(cur, tgt) {
            var d = tgt - cur;
            while (d > Math.PI) d -= 2 * Math.PI;
            while (d < -Math.PI) d += 2 * Math.PI;
            return d;
        }

        function ease(t) {
            return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
        }

        function pad(num) {
            var h = num.toString(16);
            while (h.length < 6) h = '0' + h;
            return h;
        }

        function anim() {
            requestAnimationFrame(anim);
            t += 0.016;

            var cycT = (tDur + hDur) * seq.length;
            var normT = (t % cycT) / cycT;
            var prog = normT * seq.length;
            var curI = Math.floor(prog);
            var nxtI = (curI + 1) % seq.length;
            var segP = prog - curI;
            var hRat = hDur / (tDur + hDur);
            
            var curS = seq[curI];
            var nxtS = seq[nxtI];
            var vData = verts[curS.v];
            
            if (segP > hRat) {
                var tProg = (segP - hRat) / (1 - hRat);
                var esd = ease(tProg);
                
                var dX = shortRot(curS.r.x, nxtS.r.x);
                var dY = shortRot(curS.r.y, nxtS.r.y);
                var dZ = shortRot(curS.r.z, nxtS.r.z);
                
                cube.rotation.x = curS.r.x + dX * esd;
                cube.rotation.y = curS.r.y + dY * esd;
                cube.rotation.z = curS.r.z + dZ * esd;

                var lC = new THREE.Color(vData.m).lerp(new THREE.Color(verts[nxtS.v].m), esd);
                ctr.material.color.copy(lC);
                g1.material.color.copy(lC);
                g2.material.color.copy(lC);
            } else {
                cube.rotation.x = curS.r.x;
                cube.rotation.y = curS.r.y;
                cube.rotation.z = curS.r.z;
                
                ctr.material.color.setHex(vData.m);
                g1.material.color.setHex(vData.m);
                g2.material.color.setHex(vData.m);
            }

            colorInfo.textContent = vData.n;
            colorInfo.style.color = vData.m === 0 ? '#888888' : '#' + pad(vData.m);

            var parts = '';
            for (var c = 0; c < vData.c.length; c++) {
                var cHex = vData.c[c];
                var cName = getName(cHex);
                if (c > 0) parts += ' + ';
                parts += cName;
            }
            
            if (vData.c.length === 0) {
                mixingFormula.textContent = 'No light';
            } else if (vData.c.length === 1) {
                mixingFormula.textContent = 'Primary: ' + parts;
            } else {
                var resultName = vData.n.charAt(0) + vData.n.slice(1).toLowerCase();
                mixingFormula.textContent = parts + ' = ' + resultName;
            }

            surpriseNote.textContent = vData.s || '';

            var p1 = 1 + Math.sin(t * 2.8) * 0.18;
            var p2 = 1 + Math.sin(t * 2.8 + 0.5) * 0.15;
            var p3 = 1 + Math.sin(t * 2.8 + 1.0) * 0.12;
            ctr.scale.set(p1, p1, p1);
            g1.scale.set(p2, p2, p2);
            g2.scale.set(p3, p3, p3);

            renderer.render(scene, camera);
        }

        anim();

        window.addEventListener('resize', function() {
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        });
    </script>
</body>
</html>
